<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reporte Parcial de Verificaci√≥n</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    background: #f5f6f8;
    font-family: "Segoe UI", Tahoma, sans-serif;
    color: #000;
    margin: 0;
    padding: 10px; /* Reducimos el padding general */
  }

  header {
    text-align: center;
    border-bottom: 2px solid #003366;
    padding-bottom: 6px;
    margin-bottom: 8px;
  }

  header h1 {
    font-size: 16pt; /* Reducido */
    color: #003366;
    margin: 0;
  }

  header h2 {
    font-size: 10pt; /* Reducido */
    color: #333;
    margin: 3px 0 0 0;
    font-weight: normal;
  }

  /* --- CONTENEDOR PRINCIPAL: ALINEACI√ìN Y ANCHO --- */
  .datos, .grafico-observaciones, table.resultados, .firmas {
    max-width: 680px; /* ANCHO CR√çTICO REDUCIDO PARA A4 */
    margin-left: auto;
    margin-right: auto;
  }
  
  .datos {
    margin-top: 5px;
    font-size: 10.5pt; /* Reducido */
  }

  .datos input {
    border: none;
    border-bottom: 1px solid #333;
    width: 160px; /* Reducido */
    font-size: 10.5pt;
    background: transparent;
    text-align: center;
  }
  /* Estilo espec√≠fico para el campo Misi√≥n */
  .datos input[id="mision"] {
      width: 80%;
      text-align: left;
  }

  .datos table {
    width: 100%;
    border-collapse: collapse;
  }

  .datos td {
    padding: 2px; /* Reducido */
  }

  /* --- GR√ÅFICO Y OBSERVACIONES (FLEXBOX) --- */
  .grafico-observaciones {
    display: flex;
    justify-content: space-around; /* Asegura espacio entre ambos */
    align-items: flex-start;
    margin: 8px auto; /* Reducido */
    width: 680px; 
  }

  canvas {
    display: block;
    margin: 0;
    background: #fff;
    border: 1px solid #aaa;
    border-radius: 6px; /* Bordes m√°s peque√±os */
    width: 320px !important; /* TAMA√ëO CR√çTICO REDUCIDO */
    height: 320px !important; /* TAMA√ëO CR√çTICO REDUCIDO */
  }

  .observaciones-box {
    width: 320px; /* Mismo ancho que el canvas */
    height: 320px; /* Mismo alto que el canvas */
    padding: 10px; /* Reducido */
    background: #fff;
    border: 1px solid #aaa;
    border-radius: 6px;
    box-sizing: border-box;
  }

  .observaciones-box h3 {
    margin-top: 0;
    margin-bottom: 5px; /* Reducido */
    font-size: 10.5pt;
    color: #003366;
    text-align: center;
  }

  .observaciones-box textarea {
    width: 100%;
    height: 90%;
    border: 1px solid #ccc;
    border-radius: 3px;
    padding: 6px; /* Reducido */
    font-size: 10pt; /* Reducido */
    resize: none;
    box-sizing: border-box;
  }
  
  /* --- TABLA DE RESULTADOS --- */
  table.resultados {
    margin: 8px auto;
    border-collapse: collapse;
    width: 680px; 
    font-size: 10pt; /* Reducido */
  }

  table.resultados th, table.resultados td {
    border: 1px solid #999;
    padding: 3px; /* Reducido */
    text-align: center;
  }

  table.resultados th {
    background-color: #dce6f2;
    color: #003366;
  }

  /* --- RESUMEN Y FIRMAS --- */
  .resumen {
    text-align: center;
    font-weight: 600;
    font-size: 10.5pt; /* Reducido */
    margin-top: 4px; /* Reducido */
  }

  .firmas {
    margin-top: 25px; /* Reducido */
    max-width: 680px;
    margin-left: auto;
    margin-right: auto;
    display: flex;
    justify-content: space-around;
    font-size: 10.5pt; /* Reducido */
  }

  .firmas div {
    text-align: center;
  }

  .firmas hr {
    border: none;
    border-top: 1px solid #000;
    width: 200px; /* Reducido */
    margin-bottom: 10px; /* Reducido */
    margin-top: 35px; /* Reducido */
  }

  .botonera {
    text-align: center;
    margin-top: 10px; /* Reducido */
  }

  button {
    padding: 6px 12px; /* Reducido */
    font-size: 12px; /* Reducido */
    background-color: #003366;
    color: white;
    border: none;
    border-radius: 3px;
    cursor: pointer;
  }

  /* --- AJUSTES DE IMPRESI√ìN --- */
  @media print {
    body {
      background: white;
      padding: 5mm; /* Reducimos el padding de impresi√≥n */
      margin: 0;
      transform: scale(1); /* Quitamos el escalado */
      transform-origin: top center;
    }
    .botonera { display: none !important; }
    input, textarea { border: 1px solid #ccc !important; } /* Borde sutil para impresi√≥n */
    .observaciones-box textarea {
        overflow: hidden;
        border: 1px solid #aaa !important; 
    }
  }
</style>
</head>
<body>

<header>
  <h1>REPORTE PARCIAL DE VERIFICACI√ìN</h1>
  <h2>Sistema de Entrenamiento T√°ctico de Control de Aeronaves ‚Äì SETCA</h2>
</header>

<section class="datos">
  <table>
    <tr>
      <td><strong>Alumno:</strong> <input type="text" id="alumno" placeholder="Nombre completo"></td>
      <td><strong>Instructor:</strong> <input type="text" id="instructor" placeholder="Nombre completo"></td>
    </tr>
    <tr> <td><strong>Fecha:</strong> <input type="date" id="fecha"></td>
      <td><strong>Hora:</strong> <input type="time" id="hora"></td>
    </tr>
    <tr>
      <td colspan="2"><strong>Duraci√≥n de instrucci√≥n (min):</strong> <input type="number" id="tiempo" min="0" value="60"></td>
    </tr>
    <tr> <td colspan="2"><strong>Misi√≥n:</strong> <input type="text" id="mision" placeholder="Nombre/Descripci√≥n de la Misi√≥n"></td>
    </tr>
  </table>
</section>

<div class="grafico-observaciones">
    <canvas id="radarChart"></canvas>
    
    <div class="observaciones-box">
        <h3>üìù Observaciones del Instructor</h3>
        <textarea id="observacionesTexto" placeholder="Ingrese aqu√≠ comentarios detallados sobre el desempe√±o del alumno, puntos a mejorar y logros destacados."></textarea>
    </div>
</div>

<table class="resultados" id="tablaResultados">
  <thead>
    <tr>
      <th>Indicador</th>
      <th>Puntaje</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Conciencia Situacional</td><td><input type="number" id="Conciencia" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Toma de Decisiones</td><td><input type="number" id="Decisiones" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Comunicaci√≥n</td><td><input type="number" id="Comunicacion" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Reacci√≥n</td><td><input type="number" id="Reaccion" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Precisi√≥n Vectorial</td><td><input type="number" id="Precision" min="0" max="10" value="9" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Coordinaci√≥n</td><td><input type="number" id="Coordinacion" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Dominio de Simulador</td><td><input type="number" id="Simulador" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>An√°lisis Post-Misi√≥n</td><td><input type="number" id="Analisis" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Conocimiento T√©cnico</td><td><input type="number" id="Conocimiento" min="0" max="10" value="9" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>Liderazgo bajo Estr√©s</td><td><input type="number" id="Liderazgo" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
  </tbody>
  <tfoot>
    <tr><th>Promedio General</th><th id="promedioFinal">‚Äî</th></tr>
    <tr><th>Nivel de Aptitud</th><th id="nivelAptitud">‚Äî</th></tr>
  </tfoot>
</table>

<div class="resumen" id="resultado">Modifique los puntajes para actualizar el reporte.</div>

<div class="firmas">
  <div>
    <hr>
    <span>Firma del Alumno<br><strong id="firmaAlumno">‚Äî</strong></span>
  </div>
  <div>
    <hr>
    <span>Firma del Instructor<br><strong id="firmaInstructor">‚Äî</strong></span>
  </div>
</div>

<div class="botonera">
  <button onclick="generarReporte()">Generar Reporte</button>
  <button onclick="window.print()">üñ®Ô∏è Imprimir / PDF</button>
</div>

<script>
  // IDs de los campos de puntaje
  const camposIndicadores = [
    "Conciencia","Decisiones","Comunicacion","Reaccion","Precision",
    "Coordinacion","Simulador","Analisis","Conocimiento","Liderazgo"
  ];

  const ctx = document.getElementById('radarChart');
  const radarChart = new Chart(ctx, {
    type: 'radar',
    data: {
      labels: [
        'Conciencia Situacional','Toma de Decisiones','Comunicaci√≥n','Reacci√≥n',
        'Precisi√≥n Vectorial','Coordinaci√≥n','Dominio de Simulador',
        'An√°lisis Post-Misi√≥n','Conocimiento T√©cnico','Liderazgo bajo Estr√©s'
      ],
      datasets: [{
        label: 'Desempe√±o ODI-CO',
        data: [],
        fill: true,
        backgroundColor: 'rgba(0,75,145,0.15)',
        borderColor: '#004b91',
        pointBackgroundColor: '#004b91'
      }]
    },
    options: {
      scales: {
        r: {
          min: 0, max: 10, ticks: { stepSize: 2, color: '#555' },
          grid: { color: 'rgba(0,0,0,0.1)' },
          pointLabels: { color: '#222', font: { size: 10 } }
        }
      },
      plugins: { legend: { display: false } }
    }
  });

  // Funci√≥n para actualizar puntajes y gr√°fico autom√°ticamente
  function updateScoresAutomatically() {
      const valores = camposIndicadores.map(id => {
          const input = document.getElementById(id);
          // Asegura que el valor est√© entre 0 y 10, y sea num√©rico
          let valor = parseFloat(input.value) || 0;
          if (valor < 0) valor = 0;
          if (valor > 10) valor = 10;
          // Opcional: corregir el valor en el input si est√° fuera de rango
          // input.value = valor; 
          return valor;
      });
      
      // 1. Actualizar Gr√°fico
      radarChart.data.datasets[0].data = valores;
      radarChart.update();

      // 2. Calcular Promedio y Nivel
      const promedio = valores.reduce((a,b)=>a+b,0)/valores.length;
      let nivel="";
      if (promedio>=8.5) nivel="APTO PARA MISIONES REALES";
      else if (promedio>=7) nivel="APTO PARA MISIONES VIRTUALES";
      else if (promedio>=5) nivel="EN ENTRENAMIENTO ‚Äì REQUIERE SUPERVISI√ìN";
      else nivel="NO APTO ‚Äì CONTINUAR FORMACI√ìN B√ÅSICA";

      // 3. Actualizar Resultados
      document.getElementById("promedioFinal").textContent = promedio.toFixed(2);
      document.getElementById("nivelAptitud").textContent = nivel;
      document.getElementById("resultado").textContent = `Resultado global: ${nivel} (${promedio.toFixed(1)}/10)`;
  }
  
  // Funci√≥n para "Generar Firmas" (El reporte se actualiza solo)
  function generarReporte() {
    // Solo actualiza las firmas
    const alumno = document.getElementById("alumno").value || "‚Äî";
    const instructor = document.getElementById("instructor").value || "‚Äî";
    document.getElementById("firmaAlumno").textContent = alumno;
    document.getElementById("firmaInstructor").textContent = instructor;
  }

  // Ejecutar el c√°lculo inicial al cargar la p√°gina
  window.onload = updateScoresAutomatically;
</script>

</body>
</html>
