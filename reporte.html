<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reporte Parcial de Verificaci√≥n</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  @page { size: A4; margin: 12mm; }
  body {
    font-family: "Segoe UI", Tahoma, sans-serif;
    color: #000;
    background: #fff;
    margin: 0;
    padding: 0;
    font-size: 9pt;
  }

  header {
    text-align: center;
    border-bottom: 2px solid #003366;
    padding-bottom: 3px;
    margin-bottom: 4px;
  }

  header h1 {
    font-size: 14pt;
    color: #003366;
    margin: 0;
  }

  header h2 {
    font-size: 9pt;
    color: #333;
    margin: 2px 0 0 0;
    font-weight: normal;
  }

  .datos {
    width: 100%;
    margin: 4px auto;
    font-size: 9pt;
  }

  .datos table {
    width: 100%;
    border-collapse: collapse;
  }

  .datos td {
    padding: 2px 3px;
  }

  .datos input {
    border: none;
    border-bottom: 1px solid #333;
    background: transparent;
    font-size: 9pt;
    text-align: center;
    width: 150px;
  }

  .datos input#mision {
    width: 90%;
    text-align: left;
  }

  /* RADAR Y OBSERVACIONES */
  .grafico-observaciones {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin: 4px auto;
  }

  canvas {
    width: 260px !important;
    height: 260px !important;
    border: 1px solid #ccc;
    border-radius: 6px;
    background: #fff;
  }

  .observaciones-box {
    width: 260px;
    height: 260px;
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 6px;
    box-sizing: border-box;
  }

  .observaciones-box h3 {
    margin: 0 0 4px 0;
    text-align: center;
    color: #003366;
    font-size: 9pt;
  }

  .observaciones-box textarea {
    width: 100%;
    height: 88%;
    border: 1px solid #aaa;
    border-radius: 4px;
    font-size: 8.5pt;
    resize: none;
    padding: 4px;
    box-sizing: border-box;
  }

  /* TABLA DE INDICADORES */
  table.resultados {
    border-collapse: collapse;
    width: 100%;
    margin: 6px auto;
    font-size: 8pt;
  }

  table.resultados th, table.resultados td {
    border: 1px solid #999;
    padding: 2px 3px;
  }

  table.resultados th {
    background: #dce6f2;
    color: #003366;
    text-align: center;
    font-weight: 600;
  }

  table.resultados td {
    vertical-align: middle;
  }

  table.resultados td.ind-text {
    width: 78%;
    line-height: 1.05;
  }

  table.resultados td.ind-input {
    width: 22%;
    text-align: center;
  }

  table.resultados input[type="number"] {
    width: 38px;
    text-align: center;
    font-size: 8pt;
    border: 1px solid #bbb;
    border-radius: 3px;
  }

  table.resultados tfoot th, table.resultados tfoot td {
    font-weight: 600;
    text-align: center;
    background: #f2f2f2;
  }

  /* RESULTADO Y FIRMAS */
  .resumen {
    text-align: center;
    font-weight: bold;
    font-size: 9pt;
    margin: 3px 0 2px 0;
  }

  .firmas {
    display: flex;
    justify-content: space-around;
    margin-top: 15px;
    font-size: 9pt;
  }

  .firmas div {
    text-align: center;
  }

  .firmas hr {
    border: none;
    border-top: 1px solid #000;
    width: 180px;
    margin: 40px auto 4px auto; /* espacio grande para firma */
  }

  .botonera {
    text-align: center;
    margin-top: 6px;
  }

  button {
    padding: 4px 10px;
    font-size: 9pt;
    background-color: #003366;
    color: white;
    border: none;
    border-radius: 3px;
    cursor: pointer;
  }

  @media print {
    .botonera { display: none !important; }
    html, body { margin: 0; padding: 0; }
    body { transform: scale(1); transform-origin: top center; }
  }
</style>
</head>
<body>

<header>
  <h1>REPORTE PARCIAL DE VERIFICACI√ìN</h1>
  <h2>Sistema de Entrenamiento T√°ctico de Control de Aeronaves ‚Äì SETCA</h2>
</header>

<section class="datos">
  <table>
    <tr>
      <td><strong>Alumno:</strong> <input type="text" id="alumno"></td>
      <td><strong>Instructor:</strong> <input type="text" id="instructor"></td>
    </tr>
    <tr>
      <td><strong>Fecha:</strong> <input type="date" id="fecha"></td>
      <td><strong>Hora:</strong> <input type="time" id="hora"></td>
    </tr>
    <tr>
      <td colspan="2"><strong>Duraci√≥n (min):</strong> <input type="number" id="tiempo" value="60"></td>
    </tr>
    <tr>
      <td colspan="2"><strong>Misi√≥n:</strong> <input type="text" id="mision" placeholder="Ejemplo: Interceptaci√≥n a√©rea nocturna"></td>
    </tr>
  </table>
</section>

<div class="grafico-observaciones">
  <canvas id="radarChart"></canvas>
  <div class="observaciones-box">
    <h3>üìù Observaciones del Instructor</h3>
    <textarea id="observacionesTexto" placeholder="Comentarios relevantes sobre el desempe√±o del alumno..."></textarea>
  </div>
</div>

<table class="resultados">
  <thead>
    <tr><th>Indicador</th><th>Puntaje</th></tr>
  </thead>
  <tbody>
    <tr><td>1) Breafing</td><td><input type="number" id="IND1" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>2) Ha analizado/estudiado la fase</td><td><input type="number" id="IND2" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>3) Sabe usar los medios a utilizar</td><td><input type="number" id="IND3" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>4) Respeta los par√°metros establecidos</td><td><input type="number" id="IND4" min="0" max="10" value="9" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>5) Realiza la maniobra seg√∫n la teor√≠a</td><td><input type="number" id="IND5" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>6) Determina la mejor ubicaci√≥n para el ejercicio</td><td><input type="number" id="IND6" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>7) Informa los cambios de par√°metros del blanco</td><td><input type="number" id="IND7" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>8) Cumple secuencialmente los procedimientos</td><td><input type="number" id="IND8" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>9) Precisa / Clara / Oportuna</td><td><input type="number" id="IND9" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>10) Interpreta correctamente las TTAACC</td><td><input type="number" id="IND10" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>11) Domina la fraseolog√≠a</td><td><input type="number" id="IND11" min="0" max="10" value="9" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>12) Se ubica en el espacio</td><td><input type="number" id="IND12" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>13) Realiza correcciones en la interceptaci√≥n</td><td><input type="number" id="IND13" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>14) Controla la situaci√≥n a√©rea</td><td><input type="number" id="IND14" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>15) Cumple medidas de seguridad (breaf, alturas, l√≠mites)</td><td><input type="number" id="IND15" min="0" max="10" value="8" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>16) Procedimientos ante emergencia simulada</td><td><input type="number" id="IND16" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
    <tr><td>17) Criterio para resolver situaciones no previstas</td><td><input type="number" id="IND17" min="0" max="10" value="7" oninput="updateScoresAutomatically()"></td></tr>
  </tbody>
  <tfoot>
    <tr><th>Promedio General</th><th id="promedioFinal">‚Äî</th></tr>
    <tr><th>Nivel de Aptitud</th><th id="nivelAptitud">‚Äî</th></tr>
  </tfoot>
</table>

<div class="firmas">
  <div>
    <hr>
    <span>Firma del Alumno<br><strong id="firmaAlumno">‚Äî</strong></span>
  </div>
  <div>
    <hr>
    <span>Firma del Instructor<br><strong id="firmaInstructor">‚Äî</strong></span>
  </div>
</div>

<div class="botonera">
  <button onclick="generarReporte()">Generar Reporte</button>
  <button onclick="window.print()">üñ®Ô∏è Imprimir</button>
</div>

<script>
const campos = Array.from({length:17},(_,i)=>"IND"+(i+1));
const ctx=document.getElementById('radarChart');
const radarChart=new Chart(ctx,{
  type:'radar',
  data:{labels:Array.from({length:17},(_,i)=>String(i+1)),datasets:[{data:[],fill:true,backgroundColor:'rgba(0,75,145,0.15)',borderColor:'#004b91',pointBackgroundColor:'#004b91'}]},
  options:{scales:{r:{min:0,max:10,ticks:{stepSize:2,color:'#555'},pointLabels:{color:'#000',font:{size:7},padding:2}}},plugins:{legend:{display:false}},elements:{line:{tension:0.1}}}
});
function updateScoresAutomatically(){
  const vals=campos.map(id=>Math.min(10,Math.max(0,parseFloat(document.getElementById(id).value)||0)));
  radarChart.data.datasets[0].data=vals; radarChart.update();
  const prom=vals.reduce((a,b)=>a+b,0)/vals.length;
  let nivel="";
  if(prom>=8.5) nivel="APTO PARA MISIONES REALES";
  else if(prom>=7) nivel="APTO PARA MISIONES VIRTUALES";
  else if(prom>=5) nivel="EN ENTRENAMIENTO";
  else nivel="NO APTO";
  document.getElementById("promedioFinal").textContent=prom.toFixed(2);
  document.getElementById("nivelAptitud").textContent=nivel;
  document.getElementById("resultado").textContent=`${nivel} (${prom.toFixed(1)}/10)`;
}
function generarReporte(){
  document.getElementById("firmaAlumno").textContent=document.getElementById("alumno").value||"‚Äî";
  document.getElementById("firmaInstructor").textContent=document.getElementById("instructor").value||"‚Äî";
}
window.onload=updateScoresAutomatically;
</script>
</body>
</html>
